#!/usr/bin/env php
<?php

// show all errors
error_reporting(E_ALL);

require_once __DIR__.'/../lib/Phark/ClassLoader.php';

$classloader = new \Phark\ClassLoader(array(__DIR__.'/../lib'));
$classloader->register();

$env = new \Phark\Environment();
$shell = $env->shell();

// create directories
$shell
	->mkdir($env->installDir().'/packages', 0777)
	->mkdir($env->installDir().'/activated', 0777)
	->mkdir($env->installDir().'/cache', 0777)
	;

// install phark into itself
$env->packages()->install(new \Phark\Package(__DIR__.'/../'));

// set auto_prepend_file in php.ini
$ini = \Phark\PhpIni::fromCurrent();
$ini->replace('auto_prepend_file',
	$env->installDir().'/activated/phark/phark.php');


